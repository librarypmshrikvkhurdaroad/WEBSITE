<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Book Details</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">

<!-- TOP MINISTRY BAR -->
    <div class="w-full bg-blue-800 text-white text-center py-1 text-sm font-semibold tracking-wide flex justify-center items-center">
        <span class="mx-4">‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§Æ‡§Ç‡§§‡•ç‡§∞‡§æ‡§≤‡§Ø</span>
        <span class="mx-4 border-l border-white pl-4">MINISTRY OF EDUCATION</span>
    </div>

    <!-- MAIN HEADER -->
    <header class="w-full bg-gradient-to-r from-blue-600 to-teal-500 text-white py-6 px-6">

        <div class="max-w-7xl mx-auto grid grid-cols-12 gap-4 items-center">

            <!-- LEFT LOGO -->
            <div class="col-span-2 flex justify-center">
                <img src="assets/2023042118.svg" alt="KV Logo" class="h-20 object-contain">
            </div>

            <!-- CENTER TEXT -->
            <div class="col-span-8">
                <h2 class="text-xl font-bold">‡§™‡•Ä‡§è‡§Æ ‡§∂‡•ç‡§∞‡•Ä ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡•Ä‡§Ø ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§ñ‡•Å‡§∞‡•ç‡§¶‡§æ ‡§∞‡•ã‡§°</h2>
                <h1 class="text-3xl font-extrabold uppercase">PM SHRI KENDRIYA VIDYALAYA KHURDA ROAD</h1>

                <p class="mt-2 text-sm">
                    KV Code: 1150 &nbsp; | &nbsp; CBSE Affiliation No.: 1500008 
                    &nbsp; | &nbsp; CBSE School Code: 19096
                </p>

                <p class="text-sm">
                    An autonomous body under the Ministry of Education, Government of India
                </p>
            </div>

            <!-- RIGHT LOGOS -->
            <div class="col-span-2 flex flex-col items-center space-y-3">
                <img src="assets/swachbrt.svg" alt="Swachh Bharat" class="h-10 object-contain">
                <img src="assets/pmshri.png" alt="PM SHRI" class="h-12 object-contain">
            </div>

        </div>
    </header>


<main class="max-w-4xl mx-auto p-4">
  <div id="loader" class="text-center text-gray-600">Loading book details...</div>
  <div id="bookDetails" class="hidden"></div>
</main>

<footer class="bg-blue-900 text-white p-3 text-center mt-8 text-sm">
  ¬© 2025 School Library
</footer>

<script type="module">
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

const supabase = createClient(
  "https://gtzmmhowtxvfrbdxpioh.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd0em1taG93dHh2ZnJiZHhwaW9oIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ5NzE4ODgsImV4cCI6MjA4MDU0Nzg4OH0.5Ys003VuHXLngvGQlKNJrDjQybs87H1Vs-hRGNuQPDo"
);

const googleApiKey = "AIzaSyCJGgpA594gCg8eOVOpLkhKVcs5K7Jkg38";

// Extract query params
const params = new URLSearchParams(window.location.search);
const isbn = params.get("isbn");
const acc_no = params.get("acc");

if (!isbn) document.getElementById("loader").textContent = "Invalid book";

// Metadata fetcher
async function fetchMetadata(isbn) {
  const res = await fetch(
    `https://www.googleapis.com/books/v1/volumes?q=isbn:${isbn}&key=${googleApiKey}`
  );
  const data = await res.json();
  if (!data.items) return null;

  const info = data.items[0].volumeInfo;
  return {
    title: info.title || "Unknown Title",
    author: info.authors ? info.authors.join(", ") : "Unknown Author",
    cover_url:
      info.imageLinks?.thumbnail || info.imageLinks?.smallThumbnail || "assets/placeholder.png",
    description: info.description || "No description available.",
    published: info.publishedDate || "Unknown"
  };
}

// Load book
async function loadBook() {
  const loader = document.getElementById("loader");
  const details = document.getElementById("bookDetails");

  const meta = await fetchMetadata(isbn);
  if (!meta) return loader.textContent = "Book not found";

  loader.classList.add("hidden");
  details.classList.remove("hidden");

  details.innerHTML = `
    <div class="flex flex-col md:flex-row gap-6">
      <img src="${meta.cover_url}" class="w-60 rounded shadow" />

      <div>
        <h1 class="text-3xl font-bold">${meta.title}</h1>
        <p class="text-lg text-gray-700">by <span class="font-medium">${meta.author}</span></p>
        <p class="mt-2 text-sm text-gray-600">Published: ${meta.published}</p>

        <div class="mt-4 p-2 bg-gray-100 rounded">
          <p><strong>üìå Accession No:</strong> ${acc_no}</p>
          <p><strong>üìö ISBN:</strong> ${isbn}</p>
        </div>

        
      </div>
    </div>

    <div class="mt-6">
      <h2 class="text-2xl font-semibold mb-2">üìñ Description</h2>
      <p class="text-gray-700 leading-relaxed">${meta.description}</p>
    </div>
  `;
}

loadBook();
</script>

</body>
</html>
